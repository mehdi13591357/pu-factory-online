import os
import random
import logging
from telegram.ext import Application, CommandHandler, MessageHandler, filters
from datetime import datetime

# ุชูฺฉู ุฑุจุงุช - ูโุชูุงูุฏ ุงุฒ ููู ุชูฺฉู ุงุณุชูุงุฏู ฺฉูุฏ ุง ุฑุจุงุช ุฌุฏุฏ ุจุณุงุฒุฏ
TOKEN = os.getenv('TOKEN', '8231085757:AAHVk2agQEKM1mFZ3ULk9fQiqjLEttT8HZ0')

async def start(update, context):
    user = update.message.from_user
    await update.message.reply_text(
        f"๐ญ **ุณุณุชู ุขููุงู ุชููุฏ PU - ูุณุฎู ุณุฑูุฑ**\n\n"
        f"๐ ุณูุงู {user.first_name}!\n"
        f"๐ {datetime.now().strftime('%Y-%m-%d %H:%M')}\n\n"
        "๐ **ุฏุณุชูุฑุงุช ูุฏุฑุช:**\n"
        "โข /register - ุซุจุช ุงุทูุงุนุงุช ุดุฑฺฉุช\n"
        "โข /new_order - ุซุจุช ุณูุงุฑุด ุฌุฏุฏ\n"
        "โข /my_orders - ูุดุงูุฏู ุณูุงุฑุดโูุง\n"
        "โข /price_list - ูุณุช ููุช ููุงุฏ\n"
        "โข /calculator - ูุงุดู ุญุณุงุจ ุชููุฏ\n"
        "โข /support - ูพุดุชุจุงู ูู\n"
        "โข /status - ูุถุนุช ุณุณุชู\n\n"
        "๐ **ุขููุงู 24/7 - ูุณุฎู ุณุฑูุฑ ุงุจุฑ**"
    )

async def register_company(update, context):
    await update.message.reply_text(
        "๐ข **ุซุจุช ุงุทูุงุนุงุช ุดุฑฺฉุช ุชููุฏ:**\n\n"
        "ูุทูุง ุงุทูุงุนุงุช ุดุฑฺฉุช ุฎูุฏ ุฑุง ุจู ุงู ูุฑูุช ุงุฑุณุงู ฺฉูุฏ:\n\n"
        "๐ **ูุฑูุช:**\n"
        "ุดุฑฺฉุช: [ูุงู ุดุฑฺฉุช]\n"
        "ุชููู: [ุดูุงุฑู ุชูุงุณ]\n"
        "ุขุฏุฑุณ: [ุดูุฑ ู ููุทูู]\n\n"
        "๐ **ูุซุงู:**\n"
        "ุดุฑฺฉุช: ุชููุฏ ฺฉูุด ูพูุง\n"
        "ุชููู: 09123456789\n"
        "ุขุฏุฑุณ: ุชูุฑุงูุ ุดูุฑฺฉ ุตูุนุช\n\n"
        "โ ูพุณ ุงุฒ ุซุจุชุ ูโุชูุงูุฏ ุณูุงุฑุด ุฌุฏุฏ ุซุจุช ฺฉูุฏ."
    )

async def new_order(update, context):
    order_info = """
    ๐ **ุซุจุช ุณูุงุฑุด ุชููุฏ ุฌุฏุฏ:**

    ๐ท๏ธ **ุงููุงุน ูุญุตูู:**
    โข ุฏููพุง ุงุณูพุฑุช PU
    โข ุฏููพุง ุฑุงุญุช ุจูุงุฑุณุชุงู  
    โข ุฏููพุง ฺฉูุฏฺฉ
    โข ุฏููพุง ูุงฺฉฺุฑ

    ๐ข **ููุงุฏุฑ ูพุดููุงุฏ:**
    โข 500 ุฌูุช (ุดุฑูุน ุชููุฏ)
    โข 1000 ุฌูุช (ููุฏุงุฑ ุจููู)
    โข 5000 ุฌูุช (ุชุฎูู ุญุฌู)
    โข 10000+ ุฌูุช (ููุช ูฺู)

    ๐จ **ฺฏุฒููโูุง ุฑูฺฏ:**
    โข ุชฺฉุฑูฺฏ (ููุฑูู ุจู ุตุฑูู)
    โข ุฏู ุฑูฺฏ (ูพุฑุทุฑูุฏุงุฑ)
    โข ฺูุฏุฑูฺฏ (ุจุงุฒุงุฑ ุฌูุงูุงู)
    โข ุทุฑุญ ุฏุงุฑ (ุฎุงุต)

    ๐ฐ **ุจุฑุง ูุญุงุณุจู ููุช: /calculator**
    """
    await update.message.reply_text(order_info)

async def price_list(update, context):
    prices = """
    ๐ **ูุณุช ููุช ููุงุฏ ุงููู (ูุฒุงุฑ ุชููุงู ูุฑ ฺฉูู):**

    ๐งช **ูพู ูุฑุชุงู (PU):**
    โข PU ูุฑู: 45,000 - 55,000
    โข PU ุณุฎุช: 50,000 - 60,000
    โข PU ุชุฒุฑู: 48,000 - 58,000

    ๐ **ุฏฺฏุฑ ููุงุฏ:**
    โข EVA: 25,000 - 35,000
    โข ุชุฑูููพูุงุณุชฺฉ: 30,000 - 40,000
    โข ูุงุณุชฺฉ: 40,000 - 50,000

    ๐ญ **ูุฒููโูุง ุชููุฏ (ูุฑ ุฌูุช):**
    โข ุชุฒุฑู: 3,000 - 6,000
    โข ูููุชุงฺ: 2,000 - 4,000
    โข ุจุณุชูโุจูุฏ: 1,000 - 2,000

    ๐ **ุจุฑุง ููุช ุฏูู: /calculator**
    """
    await update.message.reply_text(prices)

async def production_calculator(update, context):
    calculator = """
    ๐งฎ **ูุงุดู ุญุณุงุจ ุชููุฏ ุญุฑููโุง:**

    ๐ฐ **ุจุฑ ุงุณุงุณ ุชุนุฏุงุฏ ุณูุงุฑุด:**

    ๐น **500 ุฌูุช:**
    โข ููุงุฏ ุงููู: 12-18 ูููู ุชููุงู
    โข ูุฒูู ุชููุฏ: 2-3 ูููู ุชููุงู
    โข **ุฌูุน: 14-21 ูููู ุชููุงู**
    โข **ููุช ูุฑ ุฌูุช: 28,000 - 42,000 ุชููุงู**

    ๐น **1,000 ุฌูุช:**
    โข ููุงุฏ ุงููู: 20-30 ูููู ุชููุงู
    โข ูุฒูู ุชููุฏ: 3-4 ูููู ุชููุงู  
    โข **ุฌูุน: 23-34 ูููู ุชููุงู**
    โข **ููุช ูุฑ ุฌูุช: 23,000 - 34,000 ุชููุงู**

    ๐น **5,000 ุฌูุช:**
    โข ููุงุฏ ุงููู: 80-120 ูููู ุชููุงู
    โข ูุฒูู ุชููุฏ: 12-18 ูููู ุชููุงู
    โข **ุฌูุน: 92-138 ูููู ุชููุงู**
    โข **ููุช ูุฑ ุฌูุช: 18,000 - 27,000 ุชููุงู**

    ๐ **ูฺฉุชู:** ููุช ุชูุงู ุดุฏู ุจุง ุงูุฒุงุด ุชุนุฏุงุฏ ฺฉุงูุด ูโุงุจุฏ
    """
    await update.message.reply_text(calculator)

async def support(update, context):
    support_text = """
    ๐ **ูพุดุชุจุงู ูู ู ูุฑูุด:**

    ๐ง **ูพุดุชุจุงู ูู ุชููุฏ:**
    โข ูููุฏุณ ุนูโุฒุงุฏู: 09123456789
    โข ูุดฺฉูุงุช ุฏุณุชฺฏุงู ุชุฒุฑู
    โข ุชูุธูุงุช ููุงุฏ ู ูุฑูููุงุณูู

    ๐ผ **ูพุดุชุจุงู ูุฑูุด ู ููุช:**
    โข ุฎุงูู ูุญูุฏ: 09129876543
    โข ุงุณุชุนูุงู ููุช ู ุซุจุช ุณูุงุฑุด
    โข ูุฐุงฺฉุฑู ุชุงูู ฺฉููุฏฺฏุงู

    ๐ **ูพุดุชุจุงู ูุฌุณุชฺฉ:**
    โข ุขูุง ุฑุถุง: 09127654321
    โข ุญูู ู ููู ู ุชุฑุฎุต
    โข ูุฏุฑุช ุงูุจุงุฑ

    โฐ **ุณุงุนุงุช ฺฉุงุฑ:**
    โข ุดูุจู ุชุง ฺูุงุฑุดูุจู: ธ:ฐฐ - ฑถ:ฐฐ
    โข ูพูุฌุดูุจู: ธ:ฐฐ - ฑฒ:ฐฐ
    โข ุฌูุนู: ุชุนุทู

    ๐ง **ุงูู: support@pu-factory.com**
    """
    await update.message.reply_text(support_text)

async def status(update, context):
    await update.message.reply_text(
        "๐ข **ูุถุนุช ุณุณุชู: ูุนุงู**\n\n"
        "๐ **ุขูุงุฑ ุณุณุชู:**\n"
        "โข ูุณุฎู: ุขููุงู ุณุฑูุฑ\n"
        "โข ูุถุนุช: 24/7 ูุนุงู\n"
        "โข ุขุฎุฑู ุจุฑูุฒุฑุณุงู: ุงฺฉููู\n"
        "โข ูพุดุชุจุงู: ูุนุงู\n\n"
        "โ ุณุณุชู ุจู ุทูุฑ ฺฉุงูู operational ุงุณุช"
    )

async def handle_message(update, context):
    """ูพุฑุฏุงุฒุด ูพุงูโูุง ูุชู ุจุฑุง ุซุจุช ุงุทูุงุนุงุช"""
    text = update.message.text
    
    if 'ุดุฑฺฉุช:' in text and 'ุชููู:' in text:
        await update.message.reply_text(
            "โ **ุงุทูุงุนุงุช ุดุฑฺฉุช ุซุจุช ุดุฏ!**\n\n"
            "๐ ุงุทูุงุนุงุช ุดูุง ุฐุฎุฑู ฺฏุฑุฏุฏ.\n"
            "๐ฏ ุงฺฉููู ูโุชูุงูุฏ ุณูุงุฑุด ุฌุฏุฏ ุซุจุช ฺฉูุฏ:\n"
            "/new_order"
        )
    
    elif 'ุณูุงุฑุด' in text.lower():
        await update.message.reply_text(
            "๐ ุจุฑุง ุซุจุช ุณูุงุฑุด ุฌุฏุฏ ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:\n"
            "/new_order"
        )

# ุชูุธูุงุช ูุงฺฏ
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)

# ุฑุงูโุงูุฏุงุฒ ุฑุจุงุช
def main():
    print("๐ ุฏุฑ ุญุงู ุฑุงูโุงูุฏุงุฒ ูุณุฎู ุขููุงู ุฑุจุงุช...")
    print("๐ก ุงุชุตุงู ุจู ุณุฑูุฑ ุชูฺฏุฑุงู...")
    
    app = Application.builder().token(TOKEN).build()
    
    # ุซุจุช ุฏุณุชูุฑุงุช
    commands = [
        ("start", start),
        ("register", register_company),
        ("new_order", new_order),
        ("price_list", price_list),
        ("calculator", production_calculator),
        ("support", support),
        ("status", status)
    ]
    
    for command, handler in commands:
        app.add_handler(CommandHandler(command, handler))
    
    # ูพุฑุฏุงุฒุด ูพุงูโูุง ูุชู
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    
    print("โ ูุณุฎู ุขููุงู ุฑุจุงุช ุขูุงุฏู ุงุฌุฑุง!")
    print("๐ ุฏุฑ ุญุงู ุงุชุตุงู ุจู ุณุฑูุฑูุง ุชูฺฏุฑุงู...")
    
    app.run_polling()

if __name__ == '__main__':
    main()